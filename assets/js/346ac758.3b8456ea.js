"use strict";(globalThis.webpackChunkampache_org_docs=globalThis.webpackChunkampache_org_docs||[]).push([[4772],{187(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_04-1-2d068ca0a9d9cc9af52076c9aa7ccbb3.png"},1111(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_02-c97a1fd8045844f57469f366028eb244.png"},1856(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_04-2-dbf8c5040f7a15bebd236f6dd26bfed0.png"},2120(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_05-1b50c92717addf813a201948f92b850c.png"},3004(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_01-2eec32b379524b84a6cef4d5f46677bf.png"},3461(e,n,a){a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"docs/old-information/installation-v4","title":"Ampache4 Installation","description":"Ampache4 Installation","source":"@site/docs/docs/old-information/installation-v4.md","sourceDirName":"docs/old-information","slug":"/docs/old-information/installation-v4","permalink":"/docs/old-information/installation-v4","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Ampache4 Installation","metaTitle":"Ampache4 Installation","description":"Ampache4 Installation"},"sidebar":"api","previous":{"title":"Ampache5 for Users","permalink":"/docs/old-information/ampache5-for-users"},"next":{"title":"MySQL8 FAQ","permalink":"/docs/old-information/mysql-faq"}}');var s=a(4848),t=a(8453);const l={title:"Ampache4 Installation",metaTitle:"Ampache4 Installation",description:"Ampache4 Installation"},r=void 0,o={},c=[{value:"Installing Ampache 4",id:"installing-ampache-4",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Download",id:"download",level:2},{value:"Emplacement",id:"emplacement",level:2},{value:"git checkout example (Gentoo)",id:"git-checkout-example-gentoo",level:3},{value:"tarball example (Fedora)",id:"tarball-example-fedora",level:3},{value:"Raspbian / RaspiOS example (Debian)",id:"raspbian--raspios-example-debian",level:3},{value:"Composer",id:"composer",level:2},{value:"MySQL database creation * Debian / Raspberry Pi (PiOS)",id:"mysql-database-creation--debian--raspberry-pi-pios",level:2},{value:"Web server configuration",id:"web-server-configuration",level:2},{value:"Apache",id:"apache",level:3},{value:"Nginx",id:"nginx",level:3},{value:"Lighttpd",id:"lighttpd",level:3},{value:"Caddy",id:"caddy",level:3},{value:"Web-based Installer",id:"web-based-installer",level:2},{value:"Post Installation Tasks",id:"post-installation-tasks",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.RP)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"installing-ampache-4",children:"Installing Ampache 4"}),"\n",(0,s.jsxs)(n.p,{children:["This document is built to help you install to your local server.\nA pre-built ",(0,s.jsx)(n.a,{href:"/docker",children:"docker"})," repo is also available."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#prerequisites",children:"prerequites"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#web-server-configuration",children:"Web Server Configuration"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"A web server. All of the following have been used, though Ampache receives the most testing with Apache:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Apache"}),"\n",(0,s.jsx)(n.li,{children:"lighttpd"}),"\n",(0,s.jsx)(n.li,{children:"nginx"}),"\n",(0,s.jsx)(n.li,{children:"IIS"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"PHP => 7.1 and < 8.0 (Currently tested on php7.4-fpm)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Note: you will need PHP => 7.4 if you want to use ",(0,s.jsx)(n.a,{href:"#composer",children:"Composer"})," to manage dependencies"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"PHP modules:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PDO"}),"\n",(0,s.jsx)(n.li,{children:"PDO_MYSQL"}),"\n",(0,s.jsx)(n.li,{children:"hash"}),"\n",(0,s.jsx)(n.li,{children:"session"}),"\n",(0,s.jsx)(n.li,{children:"json"}),"\n",(0,s.jsx)(n.li,{children:"intl (Ampache develop)"}),"\n",(0,s.jsx)(n.li,{children:"simplexml (optional)"}),"\n",(0,s.jsx)(n.li,{children:"curl (optional)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"For FreeBSD The following php modules must be loaded:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"php-xml"}),"\n",(0,s.jsx)(n.li,{children:"php-dom"}),"\n",(0,s.jsx)(n.li,{children:"php-intl (Ampache develop)"}),"\n",(0,s.jsx)(n.li,{children:"MySQL"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Supported databases:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MySQL 8.x / MariaDB 10.x"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"download",children:"Download"}),"\n",(0,s.jsxs)(n.p,{children:["Release tarballs are available at ",(0,s.jsx)(n.a,{href:"https://github.com/ampache/ampache/tags",children:"github.com"}),". Depending on the feature and how recently it's changed, support might only be available for git HEAD."]}),"\n",(0,s.jsx)(n.p,{children:"You can grab the latest code for each branch directly:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/ampache/ampache/archive/release4.zip",children:"github release4"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/ampache/ampache/archive/develop.zip",children:"github develop"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Management of your deployment can be much easier if you use a git checkout rather than a tarball."}),"\n",(0,s.jsx)(n.p,{children:"These commands will check out the latest Ampache code without having to download or unpack a zip file:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"git clone -b release4 https://github.com/ampache/ampache.git ampache"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"git clone -b develop https://github.com/ampache/ampache.git ampache"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"emplacement",children:"Emplacement"}),"\n",(0,s.jsx)(n.p,{children:"Whichever method you choose, place the extracted source tree somewhere served by your webserver. The details will depend on your precise setup and desired web path; it's fairly common to put it in a folder called ampache underneath the WWW root."}),"\n",(0,s.jsx)(n.h3,{id:"git-checkout-example-gentoo",children:"git checkout example (Gentoo)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cd /var/www/localhost/htdocs\ngit clone https://github.com/ampache/ampache.git\n"})}),"\n",(0,s.jsx)(n.h3,{id:"tarball-example-fedora",children:"tarball example (Fedora)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cd /var/tmp\nwget https://github.com/ampache/ampache/archive/release4.tar.gz\ntar -xvzf release4.tar.gz\nmv release4 /var/www/html/ampache\n"})}),"\n",(0,s.jsx)(n.h3,{id:"raspbian--raspios-example-debian",children:"Raspbian / RaspiOS example (Debian)"}),"\n",(0,s.jsx)(n.p,{children:"The process for a Raspberry Pi is essentially the same as installing an Apache webserver, which Ampache runs on. The following guides may be useful:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://randomnerdtutorials.com/raspberry-pi-apache-mysql-php-lamp-server/",children:"Random Nerd tutorials * most useful"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.instructables.com/Installing-LAMP-Linux-Apache-MySQL-PHP-on-a-Raspbe/",children:"Instructables guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-install-the-ampache-music-streaming-server-on-ubuntu-18-04",children:"DigitalOcean guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.howtoforge.com/how-to-install-the-ampache-music-streaming-server-on-ubuntu-2004/",children:"Howtoforge guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nxnjz.net/2019/01/installation-of-ampache-on-ubuntu-18-04/",children:"Nxnjz.net"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"composer",children:"Composer"}),"\n",(0,s.jsxs)(n.p,{children:["Since 3.8.1, ",(0,s.jsx)(n.a,{href:"https://getcomposer.org/",children:"Composer"})," is used to manage dependencies. It is available if you are using PHP => 7.4.\nYou should download it and install it (e.g: mv composer.phar /usr/local/bin/composer), then run ",(0,s.jsx)(n.code,{children:"composer install --prefer-source --no-interaction"})," on Ampache directory.\nAttention: Composer version 2.x is not compatible to Ampache. Take care to use the latest 1.x version."]}),"\n",(0,s.jsxs)(n.p,{children:["If you cannot use Composer, you should download the release archive ",(0,s.jsx)(n.em,{children:"ampache-x.x.x_all.zip"})," which contains all dependencies."]}),"\n",(0,s.jsx)(n.p,{children:"For Mac users ( High Sierra & Mojave) * brew install composer"}),"\n",(0,s.jsx)(n.h2,{id:"mysql-database-creation--debian--raspberry-pi-pios",children:"MySQL database creation * Debian / Raspberry Pi (PiOS)"}),"\n",(0,s.jsxs)(n.p,{children:["Open a new terminal window and run:\n",(0,s.jsx)(n.code,{children:"sudo apt-get install apache2 mariadb-server mysqld php7.0 php7.0-mbstring php-mysql php7.0-gd php7.0-mcrypt php7.0-mysql php7.0-cli php7.0-curl php7.0-xml ffmpeg links git"}),"\nHit 'y' when asked if you want to install the above programs"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"sudo systemctl enable mariadb"}),"\ndepending on your setup, you might still need to use:\n",(0,s.jsx)(n.code,{children:"sudo mysql_secure_installation"})]}),"\n",(0,s.jsx)(n.p,{children:"You should see MariaDB installation instructions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"press enter to enter no root password"}),"\n",(0,s.jsx)(n.li,{children:"change the root password when prompted to something you will remember"}),"\n",(0,s.jsx)(n.li,{children:"re-enter"}),"\n",(0,s.jsx)(n.li,{children:"remove anonymous users: Y"}),"\n",(0,s.jsx)(n.li,{children:"disallow root login remotely: N"}),"\n",(0,s.jsx)(n.li,{children:"remove test DB: Y"}),"\n",(0,s.jsx)(n.li,{children:"reload privilege tables: Y"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Now run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo sync\nsudo mysql -u root -p\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"enter password you just created"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"You are now within the MySql DB, so the following commands are not Linux ones, but go straight into the MySQL DB and you will see:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"MariaDB [(none)]>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["At the above prompt, you will create the ",(0,s.jsx)(n.code,{children:"ampache"})," DB, user called ",(0,s.jsx)(n.code,{children:"amp"})," (the standard ",(0,s.jsx)(n.code,{children:"root"})," one probably won't work) and an example password of ",(0,s.jsx)(n.code,{children:"password123"}),", enter:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"CREATE DATABASE ampache;\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"CREATE USER 'amp'@'localhost' IDENTIFIED BY 'password123';\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then setup the above user you just created:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"GRANT ALL PRIVILEGES ON ampache.* TO 'amp'@'localhost';\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then type:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"FLUSH PRIVILEGES;\n"})}),"\n",(0,s.jsx)(n.p,{children:"and:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mysql",children:"EXIT;\n"})}),"\n",(0,s.jsx)(n.p,{children:"After each of the above command (except the last), you should get a return stating 'Query OK..'. If the line returns to the next one down without any reply, then your commands are not being received correctly."}),"\n",(0,s.jsxs)(n.p,{children:["See also: ",(0,s.jsx)(n.a,{href:"/docs/old-information/mysql-faq",children:"Ampache wiki * MySQL"})]}),"\n",(0,s.jsxs)(n.p,{children:["Now move/rename the following files with the following commands:\nMove these files easily when using Linux with the following commands:\n",(0,s.jsx)(n.code,{children:"sudo mv /var/www/ampache/rest/.htaccess.dist /var/www/ampache/rest/.htaccess"}),"\n",(0,s.jsx)(n.code,{children:"sudo mv /var/www/ampache/play/.htaccess.dist /var/www/ampache/play/.htaccess"}),"\n",(0,s.jsx)(n.code,{children:"sudo mv /var/www/ampache/channel/.htaccess.dist /var/www/ampache/channel/.htaccess"})]}),"\n",(0,s.jsxs)(n.p,{children:["Copy the ampache configuration ampache.cfg.php.dist file, the original ampache.cfg.php.dist is needed for admin backend as pattern for generating a new config from backend changed settings.\n",(0,s.jsx)(n.code,{children:"sudo mv /var/www/html/ampache/config/ampache.cfg.php.dist /var/www/html/ampache/config/ampache.cfg.php"})]}),"\n",(0,s.jsxs)(n.p,{children:["After copying you can easily adapt it to your needs following the ",(0,s.jsx)(n.a,{href:"/docs/configuration",children:"Basic Configuration"}),"\n'nano /var/www/html/ampache/config/ampache.cfg.php'"]}),"\n",(0,s.jsxs)(n.p,{children:["In your terminal window, we will use nano to edit an Apache file (you might use a different text editor to nano, such as vim):\n",(0,s.jsx)(n.code,{children:"sudo nano /etc/apache2/apache2.conf"}),"\nFind the following section headed:\n",(0,s.jsx)(n.code,{children:"<Directory /var/www/html/>"}),"\nSo that it reads:\n",(0,s.jsx)(n.code,{children:"<Directory /var/www/html/>"}),"\n",(0,s.jsx)(n.code,{children:"Options Indexes FollowSymLinks"}),"\n",(0,s.jsx)(n.code,{children:"AllowOverride All"}),"\n",(0,s.jsx)(n.code,{children:"Require all granted"}),"\n",(0,s.jsx)(n.code,{children:"</Directory>"}),"\nClose the window with Ctrl+X then Y to confirm changes."]}),"\n",(0,s.jsxs)(n.p,{children:["Then:\n",(0,s.jsx)(n.code,{children:"sudo nano /etc/apache2/sites-available/ampache.conf"}),"\nThere should be one section, change the ServerName from localhost to your IP such as the one below. Note the folder changes too:\n",(0,s.jsx)(n.code,{children:"<VirtualHost *:80>"}),"\n",(0,s.jsx)(n.code,{children:"ServerName 192.168.1.100"}),"\n",(0,s.jsx)(n.code,{children:"DocumentRoot /var/www/ampache"}),"\n",(0,s.jsx)(n.code,{children:"<Directory /var/www/ampache/>"}),"\n",(0,s.jsx)(n.code,{children:"AllowOverride All"}),"\n",(0,s.jsx)(n.code,{children:"Require all granted"}),"\n",(0,s.jsx)(n.code,{children:"</Directory>"}),"\n",(0,s.jsx)(n.code,{children:"RewriteEngine on"}),"\n",(0,s.jsx)(n.code,{children:"CustomLog /var/log/apache2/ampache.access.log common"}),"\n",(0,s.jsx)(n.code,{children:"ErrorLog  /var/log/apache2/ampache.error.log"}),"\n",(0,s.jsx)(n.code,{children:"</VirtualHost>"})]}),"\n",(0,s.jsx)(n.p,{children:"Run:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"sudo chmod 777 /var/www/html"}),"\n",(0,s.jsx)(n.code,{children:"sudo systemctl restart apache2"}),"\n",(0,s.jsx)(n.code,{children:"sudo a2enmod rewrite"}),"\n",(0,s.jsx)(n.code,{children:"a2ensite ampache.conf"}),"\n",(0,s.jsx)(n.code,{children:"a2enmod rewrite"}),"\n",(0,s.jsx)(n.code,{children:"a2enmod expires"}),"\n",(0,s.jsx)(n.code,{children:"systemctl restart apache2.service"})]}),"\n",(0,s.jsxs)(n.p,{children:["N.B. If you have issues in adding the source for the catalogue when setting up the webserver and the source is an external USB drive plugged into the Pi, this may be a permissions issue. Try the following to allow Ampache to read the drive correctly:\n",(0,s.jsx)(n.code,{children:"sudo chmod 777 /mnt/USB/media"}),"\n(The above example assumes your USB drive is under the /mnt directory and your files are within a folder called USB/media. If this doesn't work, try a lower level folder i.e. /mnt/USB for the above example)."]}),"\n",(0,s.jsx)(n.h2,{id:"web-server-configuration",children:"Web server configuration"}),"\n",(0,s.jsx)(n.h3,{id:"apache",children:"Apache"}),"\n",(0,s.jsxs)(n.p,{children:["Go to your web browser and direct it at the Ampache install page. For instance, if the local IP of your Ampache install is on IP 192.168.1.100, you would enter:\n",(0,s.jsx)(n.a,{href:"http://192.168.1.100/ampache/install.php",children:"http://192.168.1.100/ampache/install.php"})]}),"\n",(0,s.jsx)(n.p,{children:"Ampache is developed to work instantly with Apache without additional configuration except setting up a regular vhost."}),"\n",(0,s.jsx)(n.p,{children:"Some features requires url rewriting to work correctly. It is highly recommended to enable it."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Be sure mod_rewrite is enable on your Apache installation. Otherwise install/activate it and restart your Apache service"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check that Ampache website is allowed to override Apache settings (",(0,s.jsx)(n.code,{children:"AllowOverride All"})," in vhost config file for instance)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After Ampache installation, check that .htaccess files are installed properly. If not, copy the following files as bellow and edit them to match your Ampache public address (eg., ",(0,s.jsx)(n.code,{children:"RewriteRule ^(/[^/]+|[^/]+/|/?)$ /play/index.php"})," become ",(0,s.jsx)(n.code,{children:"RewriteRule ^(/[^/]+|[^/]+/|/?)$ /ampache/play/index.php"})," if your Ampache public url is ",(0,s.jsx)(n.code,{children:"http://localhost/ampache/"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/rest/.htaccess.dist"})," => ",(0,s.jsx)(n.code,{children:"/rest/.htaccess"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/play/.htaccess.dist"})," => ",(0,s.jsx)(n.code,{children:"/play/.htaccess"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/channel/.htaccess.dist"})," => ",(0,s.jsx)(n.code,{children:"/channel/.htaccess"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Move these files easily when using Linux with the following commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo mv /var/www/ampache/rest/.htaccess.dist /var/www/ampache/rest/.htaccess\nsudo mv /var/www/ampache/play/.htaccess.dist /var/www/ampache/play/.htaccess\nsudo mv /var/www/ampache/channel/.htaccess.dist /var/www/ampache/channel/.htaccess\n"})}),"\n",(0,s.jsx)(n.p,{children:"Copy the ampache configuration ampache.cfg.php.dist file, the original ampache.cfg.php.dist is needed for admin backend as pattern for generating a new config from backend changed settings."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo cp /var/www/html/ampache/config/ampache.cfg.php.dist /var/www/html/ampache/config/ampache.cfg.php\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After copying you can easily adapt it to your needs following the ",(0,s.jsx)(n.a,{href:"/docs/configuration",children:"Basic Configuration"}),"\n'nano /var/www/html/ampache/config/ampache.cfg.php'"]}),"\n",(0,s.jsx)(n.h3,{id:"nginx",children:"Nginx"}),"\n",(0,s.jsxs)(n.p,{children:["Working Nginx configuration sample for Ampache.\nIf Ampache is served behind a reverse proxy using SSL, you will have to uncomment ",(0,s.jsx)(n.code,{children:"fastcgi_param HTTPS on;"})," to prevent mixed content to be served."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"server {\n\n    # listen to\n    listen  [::]:used_port; #ssl; ipv6 optional with ssl enabled\n    listen       used_port; #ssl; ipv4 optional with ssl enabled\n\n    server_name my_server_name;\n    charset utf-8;\n\n    # Logging, error_log mode [notice] is necessary for rewrite_log on,\n    # (very usefull if rewrite rules do not work as expected)\n\n         error_log       /var/log/ampache/error.log; # notice;\n       # access_log      /var/log/ampache/access.log;\n       # rewrite_log     on;\n\n    # Use secure SSL/TLS settings, see https://mozilla.github.io/server-side-tls/ssl-config-generator/\n    # ssl_protocols TLSv1.2;\n    # ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-E    CDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\n    # ssl_prefer_server_ciphers on;\n    # add_header Strict-Transport-Security max-age=15768000;\n    # etc.\n\n    # Use secure headers to avoid XSS and many other things\n    add_header X-Content-Type-Options nosniff;\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Robots-Tag none;\n    add_header X-Download-Options noopen;\n    add_header X-Permitted-Cross-Domain-Policies none;\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header Referrer-Policy \"no-referrer\";\n    add_header Content-Security-Policy \"script-src 'self' 'unsafe-inline' 'unsafe-eval'; frame-src 'self'; object-src 'self'\";\n\n    # Avoid information leak\n    server_tokens off;\n    fastcgi_hide_header X-Powered-By;\n\n    root /path/to/ampache/root/directory;\n    index index.php;\n\n    # Somebody said this helps, in my setup it doesn't prevent temporary saving in files\n    proxy_max_temp_file_size 0;\n\n    # Rewrite rule for Subsonic backend\n    if ( !-d $request_filename ) {\n        rewrite ^/rest/(.*).view$ /rest/index.php?action=$1 last;\n        rewrite ^/rest/fake/(.+)$ /play/$1 last;\n    }\n\n    # Rewrite rule for Channels\n    if (!-d $request_filename){\n      rewrite ^/channel/([0-9]+)/(.*)$ /channel/index.php?channel=$1&target=$2 last;\n    }\n\n    # Beautiful URL Rewriting\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&name=$5 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&name=$6 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&player=$6&name=$7 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/bitrate/([0-9]+)/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&bitrate=$6player=$7&name=$8 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/transcode_to/(w+)/bitrate/([0-9]+)/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&transcode_to=$6&bitrate=$7&player=$8&name=$9 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&noscrobble=$6&name=$7 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&noscrobble=$6&player=$7&name=$8 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/bitrate/([0-9]+)/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&noscrobble=$6&bitrate=$7player=$8&name=$9 last;\n        rewrite ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/transcode_to/(w+)/bitrate/([0-9]+)/player/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4&client=$5&noscrobble=$6&transcode_to=$7&bitrate=$8&player=$9&name=$10 last;\n\n    # the following line was needed for me to get downloads of single songs to work\n        rewrite ^/play/ssid/(.*)/type/(.*)/oid/([0-9]+)/uid/([0-9]+)/action/(.*)/name/(.*)$ /play/index.php?ssid=$1&type=$2&oid=$3&uid=$4action=$5&name=$6 last;\n        location /play {\n                if (!-e $request_filename) {\n                rewrite ^/play/art/([^/]+)/([^/]+)/([0-9]+)/thumb([0-9]*)\\.([a-z]+)$ /image.php?object_type=$2&object_id=$3&auth=$1 last;\n                }\n\n        rewrite ^/([^/]+)/([^/]+)(/.*)?$ /play/$3?$1=$2;\n        rewrite ^/(/[^/]+|[^/]+/|/?)$ /play/index.php last;\n        break;\n        }\n\n   location /rest {\n      limit_except GET POST {\n         deny all;\n      }\n   }\n\n   location ^~ /bin/ {\n      deny all;\n      return 403;\n   }\n\n   location ^~ /config/ {\n      deny all;\n      return 403;\n   }\n\n   location / {\n      limit_except GET POST HEAD{\n         deny all;\n      }\n   }\n\n   location ~ ^/.*.php {\n        fastcgi_index index.php;\n\n    # sets the timeout for requests in [s] , 60s are normally enough\n        fastcgi_read_timeout 600s;\n\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n\n    # Mitigate HTTPOXY https://httpoxy.org/\n        fastcgi_param HTTP_PROXY \"\";\n\n    # has to be set to on if encryption (https) is used:\n        # fastcgi_param HTTPS on;\n\n        fastcgi_split_path_info ^(.+?\\.php)(/.*)$;\n\n    # chose as your php-fpm is configured to listen on\n        fastcgi_pass unix:/var/run/php5-fpm.sock;\n        # fastcgi_pass 127.0.0.1:8000/;\n   }\n\n   # Rewrite rule for WebSocket\n   location /ws {\n        rewrite ^/ws/(.*) /$1 break;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_pass http://127.0.0.1:8100/;\n   }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"lighttpd",children:"Lighttpd"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ApacheConf",children:'$HTTP["host"] == "example.com" {\n    server.document-root = "/srv/http/vhosts/example.com/public/"\n    url.rewrite-if-not-file += (\n        "^/(.*)\\.(css|js|jpg|png|gif)$" => "$0",\n        "^/rest/(.+)\\.view$" => "/rest/index.php?ssaction=$1",\n        "^/rest/fake/(.+)$" => "/play/$1",\n        "^/play/art/([^/]+)/([^/]+)/([0-9]+)/thumb([0-9]*)\\.([a-z]+)$" => "/image.php?object_type=$2&object_id=$3&auth=$1&thumb=$4&name=art.jpg",\n        "^/play/([^/]+)/([^/]+)/([^/]+)/([^/]+)(/.*)?$" => "/play/$5?$1=$2&$3=$4",\n        "^/play/([^/]+)/([^/]+)(/.*)?$" => "/play/$3?$1=$2",\n        "^/play(/[^/]+|[^/]+/|/?)$" => "/play/index.php",\n        "^/channel/([0-9]+)/(.*)$" => "/channel/index.php?channel=$1&target=$2"\n    )\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"caddy",children:"Caddy"}),"\n",(0,s.jsx)(n.p,{children:"Working caddy configuration sample for Ampache. It was converted using the nginx config."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Conf",children:"ampache.domain.com {\n    root /home/caddy/web/ampache.domain.com\n\n    log /home/caddy/web/log/ampache.domain.com.access.log {\n        rotate_size 100  # Rotate after 100 MB\n        rotate_age  14   # Keep log files for 14 days\n        rotate_keep 10   # keep maximum of 10 lof files\n    }\n\n    errors /home/caddy/web/log/ampache.domain.com.error.log\n\n    index index.php\n\n    gzip\n\n    fastcgi / unix:/var/run/php/php7.0-fpm.sock php\n\n    # Rewrite rules for Subsonic backend\n    rewrite /rest {\n        r ^/rest/(.*).view$\n        to {path}/ /rest/index.php?action={1}\n    }\n    rewrite /rest/fake {\n        r ^/rest/fake/(.+)$\n        to {path}/ /play/{1}\n    }\n\n    # Rewrite rule for Channels\n    rewrite /channel {\n        r ^/channel/([0-9]+)/(.*)$\n        to /channel/index.php?channel={1&}target={2} last;\n    }\n\n    # Beautiful URL Rewriting\n    rewrite /play/ssid {\n        r ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/name/(.*)$\n        to /play/index.php?ssid={1}&type={2}&oid={3}&uid={4}&name={5}\n\n        r ^/play/ssid/(\\w+)/type/(\\w+)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/name/(.*)$\n        to /play/index.php?ssid={1}&type={2}&oid={3}&uid={4}&client={5}&noscrobble={6}&name={7}\n\n        r ^/play/ssid/(.*)/type/(.*)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/player/(.*)/name/(.*)$\n        to /play/index.php?ssid={1}&type={2}&oid={3}&uid={4}&client={5}&noscrobble={6}&player={7}&name={8}\n\n        r ^/play/ssid/(.*)/type/(.*)/oid/([0-9]+)/uid/([0-9]+)/client/(.*)/noscrobble/([0-1])/transcode_to/(w+)/bitrate/([0-9]+)/player/(.*)/name/(.*)$\n        to /play/index.php?ssid={1}&type={2}&oid={3}&uid={4}&client={5&}noscrobble={6}&transcode_to={7}&bitrate={8}&player={9}&name={10}\n\n        r ^/play/ssid/(.*)/type/(.*)/oid/([0-9]+)/uid/([0-9]+)/action/(.*)/name/(.*)$\n        to /play/index.php?ssid={1}&type={2}&oid={3}&uid={4}action={5}&name={6}\n    }\n\n    # the following line was needed for me to get downloads of single songs to work\n    rewrite /play {\n        r ^/play/art/([^/]+)/([^/]+)/([0-9]+)/thumb([0-9]*)\\.([a-z]+)$\n        to /image.php?object_type={2}&object_id={3}&auth={1}\n\n        r ^/([^/]+)/([^/]+)(/.*)?$\n        to /play/{3}?{1}={2}\n\n        r ^/(/[^/]+|[^/]+/|/?)$\n        to /play/index.php\n    }\n\n    proxy /ws 127.0.0.1:8100 {\n        transparent\n        websocket\n        without /ws\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"web-based-installer",children:"Web-based Installer"}),"\n",(0,s.jsxs)(n.p,{children:["Assuming your web stack is set up properly and you chose the standard web path, ",(0,s.jsx)(n.a,{href:"http://localhost/ampache/",children:"this link"})," should now take you to the first step of the online installer. If you set things up in a non-standard way, navigate to your chosen install root manually."]}),"\n",(0,s.jsx)(n.p,{children:"Any potential problems with your PHP installation should show up on this initial page."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(3004).A+"",width:"1278",height:"652"})}),"\n",(0,s.jsx)(n.p,{children:'Select a language and press "Start Configuration".'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(1111).A+"",width:"1280",height:"887"})}),"\n",(0,s.jsx)(n.p,{children:"Check all errors and warnings about your environment."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(5534).A+"",width:"1279",height:"889"})}),"\n",(0,s.jsx)(n.p,{children:"Fill out the form with the database information."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(187).A+"",width:"1279",height:"888"}),"\n",(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(1856).A+"",width:"1280",height:"630"})]}),"\n",(0,s.jsx)(n.p,{children:'Fill out the form with the configuration information if needed (blank database password are not accepted). If PHP is able to write to the config/ directory, you will be able to write out the config file directly from this page. If not, or if you just prefer to do it manually, show File Insight and select "Download" and then copy it into the config/ directory manually.\nYou also define on this screen the general Ampache behavior (installation type, transcoding default settings and player backends to enable) ; if you don\'t know about this at this stage, you can change this settings later in ampache.cfg.php and Ampache preferences.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installation screenshot",src:a(2120).A+"",width:"1279",height:"645"})}),"\n",(0,s.jsx)(n.p,{children:"The final step of installation is to create the initial administrative user."}),"\n",(0,s.jsx)(n.h2,{id:"post-installation-tasks",children:"Post Installation Tasks"}),"\n",(0,s.jsxs)(n.p,{children:["You might want to look at Ampache config file in ",(0,s.jsx)(n.code,{children:"config/ampache.cfg.php.dist"}),". There are many options available that allow you to customize and change almost every feature available."]}),"\n",(0,s.jsxs)(n.p,{children:["Make sure you check out ",(0,s.jsx)(n.a,{href:"/docs/configuration",children:"Basic Configuration"})," before you dive in!"]})]})}function h(e={}){const{wrapper:n}={...(0,t.RP)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},5534(e,n,a){a.d(n,{A:()=>i});const i=a.p+"assets/images/ampache_installation_03-535774b7855b0d1e3cfbd26bef00549c.png"},8453(e,n,a){a.d(n,{RP:()=>t,xA:()=>r});var i=a(6540);const s=i.createContext({});function t(e){const n=i.useContext(s);return i.useMemo(()=>"function"==typeof e?e(n):{...n,...e},[n,e])}const l={};function r({components:e,children:n,disableParentContext:a}){let r;return r=a?"function"==typeof e?e({}):e||l:t(e),i.createElement(s.Provider,{value:r},n)}}}]);