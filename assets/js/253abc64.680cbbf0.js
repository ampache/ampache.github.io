"use strict";(globalThis.webpackChunkampache_org_docs=globalThis.webpackChunkampache_org_docs||[]).push([[4255],{7179(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"docs/development/TRANSLATIONS","title":"Translations","description":"Ampache Translation Guide","source":"@site/docs/docs/development/TRANSLATIONS.md","sourceDirName":"docs/development","slug":"/docs/development/TRANSLATIONS","permalink":"/docs/development/TRANSLATIONS","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Translations","metaTitle":"Translations","description":"Ampache Translation Guide"},"sidebar":"api","previous":{"title":"Contributing","permalink":"/docs/development/CONTRIBUTING"},"next":{"title":"Branch Layout","permalink":"/docs/development/branch-layout"}}');var t=s(4848),i=s(8453);const l={title:"Translations",metaTitle:"Translations",description:"Ampache Translation Guide"},r=void 0,o={},c=[{value:"Ampache Translation Guide",id:"ampache-translation-guide",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Questions",id:"questions",level:2},{value:"gather-messages.sh",id:"gather-messagessh",level:2},{value:"Find duplicate strings",id:"find-duplicate-strings",level:2},{value:"Transifex Client",id:"transifex-client",level:2},{value:"Basic Use",id:"basic-use",level:3},{value:"Gathering new translations",id:"gathering-new-translations",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.RP)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"ampache-translation-guide",children:"Ampache Translation Guide"}),"\n",(0,t.jsxs)(n.p,{children:["The official way to send in translations is via ",(0,t.jsx)(n.a,{href:"https://www.transifex.com/ampache/ampache/dashboard/",children:"Transifex"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The official source language of Ampache is US English."}),"\n",(0,t.jsx)(n.li,{children:"Strings should only be translated where they differ from the source language."}),"\n",(0,t.jsx)(n.li,{children:"If a translation is not available, Ampache will fall back to US English."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Ampache uses gettext to handle the translation between different languages.\nIf you are interested in translating Ampache into a new language or updating\nan existing translation please join us on Transifex."}),"\n",(0,t.jsx)(n.p,{children:"Benifits to using the Transifex platform include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Everything is managed in a central location."}),"\n",(0,t.jsx)(n.li,{children:"Translations are updated in a single commit without conflicts."}),"\n",(0,t.jsx)(n.li,{children:"The current translation state is available to the team to understand the status of each language."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"questions",children:"Questions"}),"\n",(0,t.jsx)(n.p,{children:"If you have further questions, please feel free to open an issue here or start a new thread on our GoogleGroups forum and ask for @Psy-Virus - The Translation Guy."}),"\n",(0,t.jsx)(n.p,{children:"Thanks and happy localizing!"}),"\n",(0,t.jsx)(n.h2,{id:"gather-messagessh",children:"gather-messages.sh"}),"\n",(0,t.jsxs)(n.p,{children:["To update the repository, Ampache uses a gettext script called ",(0,t.jsx)(n.code,{children:"gather-messages.sh"})]}),"\n",(0,t.jsx)(n.p,{children:"To use; cd to the base dir"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd locale/base\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then gather the new messages"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"./gather-messages.sh -g\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will generate the pot file for upload to the repo. This is needed to allow Transifex users time to translate things."}),"\n",(0,t.jsx)(n.h2,{id:"find-duplicate-strings",children:"Find duplicate strings"}),"\n",(0,t.jsx)(n.p,{children:"Because updating untranslated-strings.txt is a manual process there is room for mistakes"}),"\n",(0,t.jsx)(n.p,{children:"check for dupes using grep."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'grep -E \'^msgid "[^"]+"$\' messages.pot | sort | uniq -d -w 100 | awk \'{print "Duplicate entry:", $0}\'\n'})}),"\n",(0,t.jsx)(n.h2,{id:"transifex-client",children:"Transifex Client"}),"\n",(0,t.jsx)(n.p,{children:"To configure and use translations you need to have access tothe project and an API token to use for the client."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"https://developers.transifex.com/docs/cli"})}),"\n",(0,t.jsx)(n.h3,{id:"basic-use",children:"Basic Use"}),"\n",(0,t.jsx)(n.p,{children:"You can install the latest Transifex CLI by executing:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -o- https://raw.githubusercontent.com/transifex/cli/master/install.sh | bash\n"})}),"\n",(0,t.jsx)(n.p,{children:"Now migrate your old config if you had it installed previously"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"tx migrate\n"})}),"\n",(0,t.jsx)(n.p,{children:"With the cli tool you can pull the changes to the messages with"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"tx pull -f\n"})}),"\n",(0,t.jsx)(n.p,{children:"Here is an example of my migrated config file (~/.transifexrc) which allows me to pull the translations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"[https://www.transifex.com]\napi_hostname  = https://api.transifex.com\nhostname      = https://www.transifex.com\nusername      = api\npassword      = 1/2345675623876238476103450278634925761291\nrest_hostname = https://rest.api.transifex.com\ntoken         = 1/2345675623876238476103450278634925761291\n"})}),"\n",(0,t.jsx)(n.p,{children:"Finally, to build all the mo files which Ampache uses you need to install gettext"}),"\n",(0,t.jsx)(n.p,{children:"Now you can forcibly rebuild all the mo files with this command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd locale/base\nbash gather-messages.sh -fa\n"})}),"\n",(0,t.jsx)(n.h3,{id:"gathering-new-translations",children:"Gathering new translations"}),"\n",(0,t.jsx)(n.p,{children:"Generate a new messages.pot using the generate command."}),"\n",(0,t.jsx)(n.p,{children:"This file is used by Transifex to generate the messages for each language file."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd locale/base\nbash gather-messages.sh -g\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You can regenerate database strings by adding ",(0,t.jsx)(n.code,{children:"u"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd locale/base\nbash gather-messages.sh -gu\n"})}),"\n",(0,t.jsx)(n.p,{children:"Check for duplicate message id's in the pot"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sort messages.pot | uniq -d | grep msgid\n"})}),"\n",(0,t.jsx)(n.p,{children:'msgid "" is the only dupe you want to see. (This is used for multiline translations)'}),"\n",(0,t.jsx)(n.p,{children:"I used a regex to delete the dupes, alter to match your issues. Dupes will generally come from these generated files."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:'\\n+#:\\s*(?:Database preference subcategory table id [0-9]+|\\.\\/untranslated-strings\\.txt:[0-9]+)\\nmsgid "(?:backend|browse|catalog|custom|feature|home|httpq|lastfm|library|localplay|mpd|metadata|notification|player|podcast|privacy|query|share|Show current song in Web Player page title|sidebar|theme|transcoding|update|upload)"\\nmsgstr "[^"]*"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.RP)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{RP:()=>i,xA:()=>r});var a=s(6540);const t=a.createContext({});function i(e){const n=a.useContext(t);return a.useMemo(()=>"function"==typeof e?e(n):{...n,...e},[n,e])}const l={};function r({components:e,children:n,disableParentContext:s}){let r;return r=s?"function"==typeof e?e({}):e||l:i(e),a.createElement(t.Provider,{value:r},n)}}}]);