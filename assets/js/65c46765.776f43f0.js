"use strict";(globalThis.webpackChunkampache_org_docs=globalThis.webpackChunkampache_org_docs||[]).push([[5047],{8453(e,n,t){t.d(n,{RP:()=>i,xA:()=>a});var s=t(6540);const o=s.createContext({});function i(e){const n=s.useContext(o);return s.useMemo(()=>"function"==typeof e?e(n):{...n,...e},[n,e])}const r={};function a({components:e,children:n,disableParentContext:t}){let a;return a=t?"function"==typeof e?e({}):e||r:i(e),s.createElement(o.Provider,{value:a},n)}},8608(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"docs/configuration/broadcasts","title":"Broadcasts","description":"Ampache Broadcasts","source":"@site/docs/docs/configuration/broadcasts.md","sourceDirName":"docs/configuration","slug":"/docs/configuration/broadcasts","permalink":"/docs/configuration/broadcasts","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Broadcasts","metaTitle":"Broadcasts","description":"Ampache Broadcasts"},"sidebar":"api","previous":{"title":"Multi Artist support","permalink":"/docs/configuration/multi-artist"},"next":{"title":"Podcasts","permalink":"/docs/configuration/podcasts"}}');var o=t(4848),i=t(8453);const r={title:"Broadcasts",metaTitle:"Broadcasts",description:"Ampache Broadcasts"},a=void 0,c={},l=[{value:"Ampache Broadcasts",id:"ampache-broadcasts",level:2},{value:"How it works",id:"how-it-works",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Apache configuration",id:"apache-configuration",level:2},{value:"General configuration",id:"general-configuration",level:2},{value:"Ampache settings",id:"ampache-settings",level:3},{value:"Run",id:"run",level:3},{value:"Linux",id:"linux",level:4},{value:"Windows",id:"windows",level:4}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.RP)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"ampache-broadcasts",children:"Ampache Broadcasts"}),"\n",(0,o.jsx)(n.p,{children:"Broadcast what you're currently playing in your web player to other users."}),"\n",(0,o.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,o.jsx)(n.p,{children:"When you choose to become a broadcaster, all web player events (song change, position, play, pause ...) are transmitted to the web socket server which redistribute the information to listeners.\nListeners cannot interact with their web player which is controlled according to what you're doing on your side. This ensures connected listeners are playing the same music at the same time than you."}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"http://php.net/manual/fr/book.libevent.php",children:"libevent"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"apache-configuration",children:"Apache configuration"}),"\n",(0,o.jsx)(n.p,{children:"Apache doesn't support WebSocket by default and a proxy is needed. For WebSocket connections, proxy mod is not enough and proxy_wstunnel mod is required. Be aware that proxy_wstunnel module isn't available by default on Apache 2.2 on most distribution. Apache >= 2.4 is recommended."}),"\n",(0,o.jsx)(n.p,{children:"Enable proxy_wstunnel module then add this to your vhost:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-AmpacheConf",children:"ProxyPass /ws ws://127.0.0.1:8100 retry=0\nProxyPassReverse /ws ws://127.0.0.1:8100 retry=0\nProxyRequests off\nProxyTimeout 15\n"})}),"\n",(0,o.jsx)(n.p,{children:"You can also temporary open the binding port (8100 here) to internet access and use it directly, but it will not pass most http proxy."}),"\n",(0,o.jsx)(n.h2,{id:"general-configuration",children:"General configuration"}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"http://socketo.me/docs/deploy#serverconfiguration",children:"socketo.me"})]}),"\n",(0,o.jsx)(n.h3,{id:"ampache-settings",children:"Ampache settings"}),"\n",(0,o.jsx)(n.p,{children:"In config/ampache.cfg.php change the following settings:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-INI",children:'broadcast = true\nwebsocket_address = "ws://localhost/ws"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"run",children:"Run"}),"\n",(0,o.jsx)(n.h4,{id:"linux",children:"Linux"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"php bin/websocket_run.inc -p 8100 > /dev/null &"})}),"\n",(0,o.jsx)(n.h4,{id:"windows",children:"Windows"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"php bin\\websocket_run.inc -p 8100 > nul &"})})]})}function h(e={}){const{wrapper:n}={...(0,i.RP)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);