"use strict";(globalThis.webpackChunkampache_org_docs=globalThis.webpackChunkampache_org_docs||[]).push([[9849],{5134(e,n,r){r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"docs/old-information/ampache5-changes","title":"Ampache5 for Admins","description":"Ampache5 for Admins","source":"@site/docs/docs/old-information/ampache5-changes.md","sourceDirName":"docs/old-information","slug":"/docs/old-information/ampache5-changes","permalink":"/docs/old-information/ampache5-changes","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Ampache5 for Admins","metaTitle":"Ampache5 for Admins","description":"Ampache5 for Admins"},"sidebar":"api","previous":{"title":"Ampache6 for Users","permalink":"/docs/old-information/ampache6-for-users"},"next":{"title":"Ampache5 for Users","permalink":"/docs/old-information/ampache5-for-users"}}');var s=r(4848),t=r(8453);const a={title:"Ampache5 for Admins",metaTitle:"Ampache5 for Admins",description:"Ampache5 for Admins"},c=void 0,i={},l=[{value:"Ampache5 for Admins",id:"ampache5-for-admins",level:2},{value:"PHP 7.4, php-intl and php-gettext are <strong>required</strong>",id:"php-74-php-intl-and-php-gettext-are-required",level:2},{value:"You will need to update the web server document root",id:"you-will-need-to-update-the-web-server-document-root",level:2},{value:"Delete left over files",id:"delete-left-over-files",level:2},{value:"Don&#39;t forget to re-run composer",id:"dont-forget-to-re-run-composer",level:2},{value:"scripts and cli commands need to be updated",id:"scripts-and-cli-commands-need-to-be-updated",level:2},{value:"php-cs-fixer is out of the root folder",id:"php-cs-fixer-is-out-of-the-root-folder",level:2},{value:"test scripts and commands for checking your code have changed",id:"test-scripts-and-commands-for-checking-your-code-have-changed",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.RP)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"ampache5-for-admins",children:"Ampache5 for Admins"}),"\n",(0,s.jsx)(n.p,{children:"Ampache 5.0.0 has made a lot of changes to the PHP structure of the project."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:r(8927).A+"",width:"803",height:"446"})}),"\n",(0,s.jsx)(n.p,{children:"While it will function the same way as a user; the backend has been updated which requires a few tweaks to your install."}),"\n",(0,s.jsx)(n.p,{children:"This is a major rewrite of the PHP and will break if you aren't aware of the changes."}),"\n",(0,s.jsxs)(n.h2,{id:"php-74-php-intl-and-php-gettext-are-required",children:["PHP 7.4, php-intl and php-gettext are ",(0,s.jsx)(n.strong,{children:"required"})]}),"\n",(0,s.jsx)(n.p,{children:"PHP 7.4 support should be readily available for most servers.\nPHP 8.0 will be supported in the next release (5.1.0)"}),"\n",(0,s.jsx)(n.p,{children:"If you don't have access to php7.4 you should look at upgrading your server or staying on Ampache 4 until you can."}),"\n",(0,s.jsxs)(n.p,{children:["As well as php 7.4 Ampache 5.0.0 will also require ",(0,s.jsx)(n.strong,{children:"php-intl"})," module/dll to be enabled."]}),"\n",(0,s.jsx)(n.p,{children:"If you are unable to upgrade or want to remain on Ampache 4 you need to check out the release 4 branch."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git remote add release4 https://github.com/ampache/ampache.git\ngit fetch release4\ngit checkout release4\n"})}),"\n",(0,s.jsx)(n.h2,{id:"you-will-need-to-update-the-web-server-document-root",children:"You will need to update the web server document root"}),"\n",(0,s.jsx)(n.p,{children:"The root folder of Ampache is not the web root anymore."}),"\n",(0,s.jsxs)(n.p,{children:["The new folder is ",(0,s.jsx)(n.strong,{children:"public"})," and you will need to update your web server config."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"DocumentRoot /var/www/ampache\nDocumentRoot /var/www/ampache/public\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you're using Apache2 make sure you copy the htaccess files as well"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cp /var/www/ampache/public/rest/.htaccess.dist /var/www/ampache/public/rest/.htaccess\ncp /var/www/ampache/public/play/.htaccess.dist /var/www/ampache/public/play/.htaccess\ncp /var/www/ampache/public/channel/.htaccess.dist /var/www/ampache/public/channel/.htaccess\n"})}),"\n",(0,s.jsx)(n.h2,{id:"delete-left-over-files",children:"Delete left over files"}),"\n",(0,s.jsx)(n.p,{children:"While updating from git there will be some left over files that are not deleted due to the structural change."}),"\n",(0,s.jsx)(n.p,{children:"You can manually delete these folders"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"rm -rf ./channel\nrm -rf ./play\nrm -rf ./rest\nrm -rf ./lib\n"})}),"\n",(0,s.jsx)(n.h2,{id:"dont-forget-to-re-run-composer",children:"Don't forget to re-run composer"}),"\n",(0,s.jsx)(n.p,{children:"You will need to make sure you've run composer install again."}),"\n",(0,s.jsx)(n.p,{children:"It should run but it's good to manually check."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"composer install\n"})}),"\n",(0,s.jsx)(n.p,{children:"Composer 1 and 2 are both supported now so it should not matter which version you use."}),"\n",(0,s.jsx)(n.h2,{id:"scripts-and-cli-commands-need-to-be-updated",children:"scripts and cli commands need to be updated"}),"\n",(0,s.jsx)(n.p,{children:"The /bin folder has combined each script into a single application."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"bin/cli\n"})}),"\n",(0,s.jsx)(n.p,{children:"All your commands will need to be updated to match the new command structure."}),"\n",(0,s.jsx)(n.p,{children:"For example the cron.service command has changed to the following"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"ExecStart=php bin/cron.inc\nExecStart=php bin/cli run:cronProcess\n"})}),"\n",(0,s.jsx)(n.p,{children:"Arguments and options remain the same (with some minor exceptions)"}),"\n",(0,s.jsxs)(n.p,{children:["Check out the ",(0,s.jsx)(n.a,{href:"/docs/help/troubleshooting/cli",children:"cli faq"})," to migrate your commands."]}),"\n",(0,s.jsx)(n.p,{children:"The cli program has a --help switch for all commands."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:r(7359).A+"",width:"724",height:"596"})}),"\n",(0,s.jsx)(n.h2,{id:"php-cs-fixer-is-out-of-the-root-folder",children:"php-cs-fixer is out of the root folder"}),"\n",(0,s.jsx)(n.p,{children:"If you used ./php-cs-fixer from root it's still there in the vendor folder (/vendor/bin/php-cs-fixer)"}),"\n",(0,s.jsx)(n.h2,{id:"test-scripts-and-commands-for-checking-your-code-have-changed",children:"test scripts and commands for checking your code have changed"}),"\n",(0,s.jsx)(n.p,{children:"Anyone who wants to create a pull for Ampache can check their code by executing the test scripts."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"bash ./resources/scripts/tests/*\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.RP)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},7359(e,n,r){r.d(n,{A:()=>o});const o=r.p+"assets/images/131268352-c3877dd0-c5c8-4f9a-a5b9-726a734c79dc-3b241cd74ded7377281b403b939d0908.png"},8453(e,n,r){r.d(n,{RP:()=>t,xA:()=>c});var o=r(6540);const s=o.createContext({});function t(e){const n=o.useContext(s);return o.useMemo(()=>"function"==typeof e?e(n):{...n,...e},[n,e])}const a={};function c({components:e,children:n,disableParentContext:r}){let c;return c=r?"function"==typeof e?e({}):e||a:t(e),o.createElement(s.Provider,{value:c},n)}},8927(e,n,r){r.d(n,{A:()=>o});const o=r.p+"assets/images/131267485-ed6792d2-4bc0-4599-8277-109fe98eaffe-01a407e1d8f9ebacf4671557714fd555.png"}}]);