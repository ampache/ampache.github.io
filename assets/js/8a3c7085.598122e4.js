"use strict";(globalThis.webpackChunkampache_org_docs=globalThis.webpackChunkampache_org_docs||[]).push([[9952],{2045(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"docs/configuration/subsonic","title":"Subsonic API","description":"Ampache Subsonic API","source":"@site/docs/docs/configuration/subsonic.md","sourceDirName":"docs/configuration","slug":"/docs/configuration/subsonic","permalink":"/docs/configuration/subsonic","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Subsonic API","metaTitle":"Subsonic API","description":"Ampache Subsonic API"},"sidebar":"api","previous":{"title":"Ampache API","permalink":"/docs/configuration/api"},"next":{"title":"Cron","permalink":"/docs/configuration/cron"}}');var r=n(4848),i=n(8453);const a={title:"Subsonic API",metaTitle:"Subsonic API",description:"Ampache Subsonic API"},o=void 0,c={},l=[{value:"Ampache Subsonic API",id:"ampache-subsonic-api",level:2},{value:"Errors during Playback",id:"errors-during-playback",level:2},{value:"Allow access from your Ampache server to your external IP-address on port 443",id:"allow-access-from-your-ampache-server-to-your-external-ip-address-on-port-443",level:3},{value:"Set the local_web_path",id:"set-the-local_web_path",level:3},{value:"Make sure you are not accessing an https site in http",id:"make-sure-you-are-not-accessing-an-https-site-in-http",level:3}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.RP)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"ampache-subsonic-api",children:"Ampache Subsonic API"}),"\n",(0,r.jsx)(s.p,{children:"Your Ampache server can be accessed through the Subsonic API."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Required"}),(0,r.jsx)(s.th,{children:"Default"}),(0,r.jsx)(s.th,{children:"Comment"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"u"}),(0,r.jsx)(s.td,{children:"Yes"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:"The username."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"p"}),(0,r.jsx)(s.td,{children:"Yes*"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:'The password, either in clear text or hex-encoded with a "enc:" prefix. Since 4.0.0 this should only be used for testing purposes.'})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"t"}),(0,r.jsx)(s.td,{children:"Yes*"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:"(Since 4.0.0) The authentication token computed as md5(apikey + salt). See below for details."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"s"}),(0,r.jsx)(s.td,{children:"Yes*"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:'(Since 4.0.0) A random string ("salt") used as input for computing the password hash. See below for details.'})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"v"}),(0,r.jsx)(s.td,{children:"Yes"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:"The protocol version implemented by the client, i.e., the version of the subsonic-rest-api.xsd schema used (see below)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"c"}),(0,r.jsx)(s.td,{children:"Yes"}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:"A unique string identifying the client application."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"f"}),(0,r.jsx)(s.td,{children:"No"}),(0,r.jsx)(s.td,{children:"xml"}),(0,r.jsx)(s.td,{children:'Request data to be returned in this format. Supported values are "xml", "json", "jsonp". If using jsonp, specify name of javascript callback function using a callback parameter.'})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"(*) Either p or both t and s must be specified."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Note"})," token auth in Ampache requires a user apikey. This is due to the differences in how Subsonic and Ampache store passwords."]}),"\n",(0,r.jsx)(s.p,{children:"Remember to URL encode the request parameters. All methods (except those that return binary data) returns XML documents conforming to the subsonic-rest-api.xsd schema. The XML documents are encoded with UTF-8.\nAuthentication"}),"\n",(0,r.jsx)(s.p,{children:"If Ampache version 3.x.x, authentication is performed by sending the password as clear text or hex-encoded. Examples:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-URL",children:"http://your-server/rest/ping.view?u=joe&p=sesame&v=1.12.0&c=myapp\nhttp://your-server/rest/ping.view?u=joe&p=enc:736573616d65&v=1.12.0&c=myapp\n"})}),"\n",(0,r.jsx)(s.p,{children:"Starting with Ampache version 4.0.0, the recommended authentication scheme is to send an authentication token, calculated as a one-way salted hash of the password."}),"\n",(0,r.jsx)(s.p,{children:"This involves two steps:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"For each REST call, generate a random string called the salt. Send this as parameter s."}),"\n",(0,r.jsx)(s.li,{children:"Use a salt length of at least six characters."}),"\n",(0,r.jsx)(s.li,{children:"Calculate the authentication token as follows: token = md5(password + salt). The md5() function takes a string and returns the 32-byte ASCII hexadecimal representation of the MD5 hash, using lower case characters for the hex values. The '+' operator represents concatenation of the two strings. Treat the strings as UTF-8 encoded when calculating the hash. Send the result as parameter t."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:'For example: if the password is sesame and the random salt is c19b2d, then token = md5("sesamec19b2d") = 26719a1196d2a940705a59634eb18eab. The corresponding request URL then becomes:'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-URL",children:"http://your-server/rest/ping.view?u=joe&t=26719a1196d2a940705a59634eb18eab&s=c19b2d&v=1.12.0&c=myapp\n"})}),"\n",(0,r.jsx)(s.p,{children:"Example from the Subsonic API documentation:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-URL",children:"http://your-server/rest/ping.view?u=joe&p=sesame&v=1.12.0&c=myapp\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Note"}),": Default configuration assumes your Ampache installation resides at the root of your webserver.\nIf you are serving it from a subfolder (say ",(0,r.jsx)(s.code,{children:"/ampache/"}),"), you should:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Set ",(0,r.jsx)(s.code,{children:"web_path"})," in your config:"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-INI",children:'web_path = "/ampache"\n;local_web_path = ""\n'})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Edit the ",(0,r.jsx)(s.code,{children:".htaccess"})," file accordingly, e.g. replacing ",(0,r.jsx)(s.code,{children:"/play/"})," by ",(0,r.jsx)(s.code,{children:"/ampache/play"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"errors-during-playback",children:"Errors during Playback"}),"\n",(0,r.jsx)(s.p,{children:'When your Subsonic Client can successfully login to your Ampache server, brwose the Library,\nbut fails to play music (Client status is "Downloading 0 B"), try one of the following:'}),"\n",(0,r.jsx)(s.h3,{id:"allow-access-from-your-ampache-server-to-your-external-ip-address-on-port-443",children:"Allow access from your Ampache server to your external IP-address on port 443"}),"\n",(0,r.jsxs)(s.p,{children:["Applies when you see something like the following in your Ampache log (Provided logging is turned on):\n",(0,r.jsx)(s.code,{children:"2020-09-15T19:02:29+00:00 [bbl] (subsonic_api.class) -> Stream error: Failed to connect to your-external-hostname port 443: Connection timed out"})]}),"\n",(0,r.jsx)(s.h3,{id:"set-the-local_web_path",children:"Set the local_web_path"}),"\n",(0,r.jsx)(s.p,{children:"This applies if Ampache is running behind a reverse proxy.\nThe following are typical error messages:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"(Ampache\\Module\\Api\\Subsonic_Api) -> Stream error:\n(Ampache\\Module\\Api\\Subsonic_Api) -> Stream error: The requested URL returned error: 404 Not Found\n"})}),"\n",(0,r.jsxs)(s.p,{children:["In ",(0,r.jsx)(s.code,{children:"ampache.cfg.php"})," set ",(0,r.jsx)(s.code,{children:"local_web_path"})," to ",(0,r.jsx)(s.code,{children:"localhost"}),".\nThere are various discussions and issues with more detail on this,\nsee for example: ",(0,r.jsx)(s.a,{href:"https://github.com/ampache/ampache/issues/1639",children:"Issue 1639"})]}),"\n",(0,r.jsx)(s.h3,{id:"make-sure-you-are-not-accessing-an-https-site-in-http",children:"Make sure you are not accessing an https site in http"}),"\n",(0,r.jsxs)(s.p,{children:["Changing ",(0,r.jsx)(s.code,{children:"server preferences"})," can solve that problem :"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["forcing http streaming must be set to ",(0,r.jsx)(s.code,{children:"inactive"}),"\n",(0,r.jsx)(s.img,{src:"https://github.com/ampache/ampache/assets/3218235/cd40a343-ba37-422d-bf0e-1c2eec678bce",alt:"image"})]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.RP)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,s,n){n.d(s,{RP:()=>i,xA:()=>o});var t=n(6540);const r=t.createContext({});function i(e){const s=t.useContext(r);return t.useMemo(()=>"function"==typeof e?e(s):{...s,...e},[s,e])}const a={};function o({components:e,children:s,disableParentContext:n}){let o;return o=n?"function"==typeof e?e({}):e||a:i(e),t.createElement(r.Provider,{value:o},s)}}}]);